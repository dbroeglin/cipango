<?xml version="1.0"?>
<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://jetty.mortbay.org/configure.dtd">

<!-- =============================================================== -->
<!-- Configure Cipango Plus features based on Jetty Plus             -->
<!--                                                                 -->
<!-- This file sets up a WebAppDeployer to automatically deploy all  -->
<!-- webapps in $jetty.home/sipapps-plus at startup time, and to     -->
<!-- enable all of them with Plus features (jndi etc).               -->
<!--                                                                 -->
<!-- You can instead configure individual sipapps with Cipango Plus  -->
<!-- features by using the ContextDeployer (configured in            -->
<!-- $jetty.home/etc/cipango.xml), and ensuring that you set the     -->
<!-- same set of classes listed below in the "plusConfig" as the     -->
<!-- webapp's configurationClasses.                                  -->
<!--                                                                 -->
<!-- =============================================================== -->
<Configure id="Server" class="org.cipango.Server">

  <!-- =========================================================== -->
  <!-- Example JAAS realm setup.                                   -->
  <!-- The LoginModuleName must be exactly the same as in the      -->
  <!-- login.conf file, and the realm Name must be the same as in  -->
  <!-- the web.xml file.                                           -->
  <!-- =========================================================== -->
  <!-- 
  <Call name="addUserRealm">
    <Arg>
      <New class="org.mortbay.jetty.plus.jaas.JAASUserRealm">
	      <Set name="name">xyzrealm</Set>
	      <Set name="LoginModuleName">xyz</Set>
	    </New>
    </Arg>
  </Call>
  -->

  <!-- =========================================================== -->
  <!-- Configurations for WebAppContexts                           -->
  <!-- Sequence of configurations to enable Plus features.         -->
  <!-- =========================================================== -->
  <Array id="plusConfig" type="java.lang.String">
    <Item>org.mortbay.jetty.webapp.WebInfConfiguration</Item>
    <Item>org.mortbay.jetty.plus.webapp.EnvConfiguration</Item>
    <Item>org.cipango.plus.webapp.Configuration</Item>
    <Item>org.mortbay.jetty.webapp.JettyWebXmlConfiguration</Item>
    <Item>org.mortbay.jetty.webapp.TagLibConfiguration</Item>
    <Item>org.cipango.plus.sipapp.Configuration</Item>
  </Array>

  <!-- =========================================================== -->
  <!-- Deploy all sipapps in sipapps-plus                          -->
  <!-- =========================================================== -->
  <!-- Uncomment the following to set up a WebAppDeployer that will -->
  <!-- deploy webapps from a directory called sipapps-plus. Note    -->
  <!-- that you will need to create this directory first!           -->
  <!--  -->
   
  <Call name="addLifeCycle">
    <Arg>
      <New class="org.cipango.deployer.SipAppDeployer">
        <Set name="contexts"><Ref id="Contexts"/></Set>
        <Set name="webAppDir"><SystemProperty default="." name="jetty.home"/>/sipapps-plus</Set>
        <Set name="parentLoaderPriority">false</Set>
        <Set name="extract">true</Set>
        <Set name="allowDuplicates">false</Set>
        <Set name="defaultsDescriptor"><SystemProperty default="." name="jetty.home"/>/etc/webdefault.xml</Set>
        <Set name="defaultsSipDescriptor"><SystemProperty default="." name="jetty.home"/>/etc/sipdefault.xml</Set>
        <Set name="configurationClasses"><Ref id="plusConfig"/></Set>
      </New>
    </Arg>
  </Call>

</Configure>

